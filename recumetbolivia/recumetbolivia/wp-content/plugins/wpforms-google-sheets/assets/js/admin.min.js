"use strict";const WPFormsGoogleSheetsAdmin=window.WPFormsGoogleSheetsAdmin||function(e,n,i){const r={$holder:null,init:function(){i(r.ready)},ready:function(){r.$holder=i(".wpforms-settings-provider-accounts-toggle-google-sheets"),i(e).on("wpformsProviderRemoved",r.removeProvider),r.$holder.on("click",".wpforms-btn",r.saveCredentials).on("click",".js-wpforms-google-sheets-setting-field-redirect-uri-copy",r.copyUrlClick)},removeProvider:function(e,t){"wpforms-integration-google-sheets"===t.attr("id")&&t.find(".wpforms-settings-provider-accounts-toggle-google-sheets").removeClass("wpforms-hidden")},saveCredentials:function(e){e.preventDefault();var e=i(this),t=r.getFormMode(e);if(r.isValidForm(e)){const o={nonce:wpforms_admin.nonce,action:"wpforms_google_sheets_get_auth_url",account_name:r.getFieldValueByName("account_name"),mode:t};"advanced"===t&&(o.client_id=r.getFieldValueByName("client_id"),o.client_secret=r.getFieldValueByName("client_secret")),r.request(o,e)}else WPFormsAdmin.integrationError("<p>"+wpforms_admin.provider_auth_error+"</p><p>"+wpforms_admin.google_sheets_required_fields+"</p>")},isValidForm:function(e){if("advanced"!==r.getFormMode(e))return!0;var e=r.getFieldValueByName("client_id"),t=r.getFieldValueByName("client_secret");return Boolean(e.length&&t.length)},getFieldValueByName:function(e){const t=i('[name="'+e+'"]',r.$holder);return t.length?t.val().toString().trim():""},getFormMode:function(e){return e.closest(".wpforms-settings-provider-accounts-connect").length?"advanced":"pro"},request:function(e,t){const o=t.html(),r=t.outerWidth();i.ajax({url:wpforms_admin.ajax_url,type:"post",dataType:"json",data:e,beforeSend:function(){t.css("width",r).text(wpforms_admin.connecting).prop("disabled",!0)},success:function(e){n.location.href=e.data},error:function(e){e=JSON.parse(e.responseText),e=Object.prototype.hasOwnProperty.call(e,"data")&&e.data?e.data:wpforms_admin.something_went_wrong;WPFormsAdmin.integrationError(e)},complete:function(){t.css("width","").html(o).prop("disabled",!1)}})},copyUrlClick:function(){const e=i(this);var t=e.closest(".wpforms-google-sheets-setting-field-redirect-uri-row");const o="wpforms-google-sheets-setting-field-redirect-uri-copy-success",r=i(".wpforms-google-sheets-setting-field-redirect-uri-input",t);r.select(),navigator.clipboard.writeText(r.val()).then(function(){e.addClass(o),setTimeout(function(){e.removeClass(o)},500)})}};return r}(document,window,jQuery);WPFormsGoogleSheetsAdmin.init();